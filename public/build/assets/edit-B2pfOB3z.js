import{m as F,r as V,j as e,L as G}from"./app-BvJTPa4F.js";import{F as M}from"./form-loop-kriteria-B4gw8LNk.js";import{I as _}from"./input-error-CLJW2rfn.js";import{B as q}from"./button-B_C3jsia.js";import{L as A}from"./label-BPlB6m5R.js";import{S as P,a as R,b as U,c as $,d as H}from"./select-D-qCTuss.js";import{A as J}from"./app-layout-Br9h_7Ez.js";import{L as O}from"./loader-circle-CSHmarIV.js";import"./input-BhlM952y.js";import"./index-BaqpAR-j.js";import"./index-B9dZ-KWS.js";import"./use-mobile-navigation-BwpiycPh.js";import"./proxy-B0oIBWLF.js";import"./check-DxIZI4OL.js";import"./person-standing-Bd8ReaRt.js";import"./react-icons.esm-BKo58YvE.js";import"./chevron-down-EWV8qnUl.js";function dr({breadcrumb:h,kriteria:s,titlePage:L,dataset:l,opsiLabel:I}){const C=h?h.map(r=>({title:r.title,href:r.href})):[],{data:m,setData:t,put:D,processing:g,errors:j}=F({id:(l==null?void 0:l.id)??0,label:(l==null?void 0:l.label)||"",kriteria:s.map(r=>{const i=l==null?void 0:l.detail.find(a=>Number(a.kriteria_id)===Number(r.id));return{kriteria_id:Number(r.id),nilai:(i==null?void 0:i.nilai)||null}})}),E=V.useCallback(r=>{const{name:i,value:a}=r.target,[c,x]=i.split("."),d=Number(x);c==="kriteria"?(a===""||/^-?\d*\.?\d*$/.test(a))&&t(p=>{var k,v,B;const o=(k=p.kriteria)==null?void 0:k.map((n,u)=>u===d?{...n,nilai:a}:n),b=s.findIndex(n=>n.nama.includes("BB")),f=s.findIndex(n=>n.nama.includes("TB")),y=s.findIndex(n=>n.nama.toLowerCase().includes("imt"));if((d===b||d===f)&&y!==-1){const n=Number(d===b?a:((v=o==null?void 0:o[b])==null?void 0:v.nilai)??0),u=Number(d===f?a:((B=o==null?void 0:o[f])==null?void 0:B.nilai)??0);if(n>0&&u>0)return{...p,kriteria:o==null?void 0:o.map((S,z)=>z===y?{...S,nilai:w(n,u)}:S)}}return{...p,kriteria:o}}):t(p=>({...p,[i]:a}))},[s,t]),w=(r,i)=>{const a=i/100;return(r/(a*a)).toFixed(3)},N=(r,i)=>{r&&i!==void 0&&m&&m.kriteria?t(r==="label"?a=>({...a,[r]:i}):a=>({...a,kriteria:a.kriteria.map((c,x)=>x===Number(r)?{...c,nilai:i}:c)})):console.error("Invalid data: name, value, or kriteria may be undefined")},T=r=>{r.preventDefault(),D(route("admin.dataset.update",m.id),{onError:i=>{console.log(i)},onSuccess:()=>{}})};return e.jsxs(J,{breadcrumbs:C,children:[e.jsx(G,{title:L??"Edit Data Dataset Gizi"}),e.jsxs("div",{className:"mx-auto max-w-7xl rounded-xl border border-gray-100 bg-white p-6 shadow",children:[e.jsx("h1",{className:"mb-6 text-center text-xl font-semibold text-primary",children:"Edit Data Dataset Gizi"}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:e.jsxs("div",{children:[e.jsx(A,{className:"text-xs text-gray-600",children:"Label"}),e.jsxs(P,{value:m.label,required:!0,onValueChange:r=>N("label",r),children:[e.jsx(R,{className:"input-minimal",children:e.jsx(U,{placeholder:"Pilih"})}),e.jsx($,{children:I.map((r,i)=>e.jsx(H,{value:r.nama,children:r.nama},i))})]}),j.label&&e.jsx(_,{message:j.label,className:"mt-2"})]})}),e.jsx(M,{kriteria:s,data:m,setData:t,handleChange:E,handleSelectChange:N,processing:g}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(q,{type:"submit",variant:"default",children:[g&&e.jsx(O,{className:"h-4 w-4 animate-spin"}),"Update Data"]})})]})]}),e.jsx("style",{children:`
                .input-minimal {
                    background: #f9fafb;
                    border: 1px solid #e5e7eb;
                    border-radius: 8px;
                    padding: 8px 12px;
                    font-size: 14px;
                    outline: none;
                    transition: border 0.2s;
                }
                .input-minimal:focus {
                    border-color: var(--color-primary, #2563eb);
                    background: #fff;
                }
                .bg-primary { background-color: var(--color-primary, #2563eb); }
                .bg-primary-dark { background-color: var(--color-primary-dark, #1d4ed8); }
                .text-primary { color: var(--color-primary, #2563eb); }
            `})]})}export{dr as default};
